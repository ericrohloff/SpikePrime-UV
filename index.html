<!DOCTYPE html>
<html lang="en">
    <head>
        <title>UV</title>

        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0" />

        <!-- PyScript CSS -->
        <link
            rel="stylesheet"
            href="https://pyscript.net/releases/2024.7.1/core.css"
        />

        <!-- This script tag bootstraps PyScript -->
        <script
            type="module"
            src="https://pyscript.net/releases/2024.7.1/core.js"
        ></script>
        <link rel="stylesheet" href="styles.css" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/min/moment.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.0.0/dist/chartjs-adapter-moment.min.js"></script>
    </head>
    <body>
        <script
            type="mpy"
            src="./main.py"
            config="./pyscript.toml"
            async
        ></script>
        <script src="app.js"></script>

        <h1>UV Index Activity</h1>
        <p>
            You and your friends are planning to play frisbee in the park. You
            need to know the UV index and temperature to make sure you are safe
            and when the best time to play is between 9am and 5pm. You have a
            Spike Prime and a UV sensor to help you with this task. You will use
            the UV sensor to get the UV index and compare it to the local
            weather station temperature. Then use Python to analyze the data to
            find the best time to play with your friends. When you have
            collected all your data press "Get Data" to get your UV Data.
        </p>

        <h2>Connect to Spike and Pico</h2>
        <p>
            First connect up to the Spike Prime in order to communicate to the
            RoboPico. This will let us grab data on when the best time to play
            frisbee is.
        </p>
        <button id="connect">connect up</button>
        <button id="library">load BLE library</button>
        <progress id="progress" value="0" max="100" hidden>0%</progress>
        <br /><br />
        <select name="files" id="files"></select>
        <button id="upload">Grab remote code</button>
        <button id="clear">Clear</button>
        <button id="test">BLE Test Code</button> <br /><br />
        <button id="data">Get Data</button>
        <script id="mpCode" type="mpy-editor" env="ble"></script>
        <div id="repl"></div>

        <h2>Get UV Data</h2>
        <p>
            Now that we have the UV data running. We need to compare it to the
            the local temperature data from the nearest weather station. To do
            this we will use data from an API. This will give use the
            temperature for the local area. Look at both of these data sets to
            see if they match up.
        </p>
        <canvas id="tempChart" width="400" height="200"></canvas>

        <h2>Data Science Go!</h2>
        <p>
            Now that we have the UV data from the local weather station and the
            UV data from the Spike Prime. We can compare the two data sets to
            see how accurate the Spike Prime is and see if the UV index matches
            the weather. First add the sensor data to the graph above using the
            "Add Sensor Data" button. Next start playing with the data using the
            "Start Analyzing" button to find the best time to play frisbee.
        </p>
        <button id="get_sensor_data">Graph Sensor Data</button>
        <button id="to_python">Use Sensor Data</button>
        <script type="py-editor" env="graph" config="matplotlib.toml">
            ## This is matplotlib code to plot the data try experimenting with the settings and find out what time is the best time to play frisbee. ##

            import matplotlib.pyplot as plt
            import numpy as np
            from pyscript import display

            x = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
            y = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])

            ## Settings for the plot ##

            plt.plot(x, y, label='data!') # Change the label
            plt.title('Sample Plot') # Change the Title!
            plt.xlabel('Date and Time') # Change the x-axis label!
            plt.ylabel('UV Index') # Change the y-axis label!

            plt.legend()
            plt.grid(True)

            display(plt, target="set_up")
        </script>
        <div id="set_up"></div>
    </body>
</html>
